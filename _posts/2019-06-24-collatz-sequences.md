---
layout: post
title:  "Collatz sequences"
date:   2019-06-24 17:20 -0800
categories: python math
---

The [Collatz sequence](http://mathworld.wolfram.com/CollatzProblem.html) for a whole number _n_ is generated by iterating:

```
a_n = (1/2) * a_n-1    if a_n-1 is even
a_n = 3*a_n-1 + 1      if a_n-1 is odd
```

The [Collatz conjecture](https://en.wikipedia.org/wiki/Collatz_conjecture) is that this sequence always terminates at 1. The Wikipedia entry has a [graph](https://en.wikipedia.org/wiki/Collatz_conjecture#/media/File:Collatz1000mathematica.png) by [Jon McLoone](http://jon.mcloone.info/), Director at Wolfram Research and all-around interesting person. I thought that was cool and wanted to make my own, so here's what I came up with:


![collatz graph]({{ "/images/collatz_graph_1000_small_2.png" | absolute_url }})

Also, check out the [humungo version](https://github.com/cbare/Etudes/blob/master/images/collatz_graph_1000.svg) and the [source](https://github.com/cbare/Etudes/blob/master/python/number_theory.py) that generated it using pygraphviz and GraphViz.

Why does this work? Thinking in terms of prime factors, the _half_ rule removes factors of 2. The _triple-plus-one_ rule increases the next value, but makes sure there's always at least one factor of 2 to remove. For the cases where _triple-plus-one_ yields more than one factor of 2, we've made a profit. After removing twos by _halfing_, the remaining factors are less than the odd number we _tripled-plus-one_.

Longer paths tend to be chock-full of primes, like the sequence for 89 in which every odd number is a prime. Does knowing that a number is of the form _3n+1_ or _(3n+1)/2_ tell us anthing about its prime factors? Does it help to remember that all primes are of one of two forms, either _6n+1_ or _6n-1_?

Well, the Collatz conjecture remains unproven for reason.
